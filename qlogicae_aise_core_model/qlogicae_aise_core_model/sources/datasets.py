
def escape_braces(template):
    result = ""
    i = 0
    while i < len(template):
        if template[i:i+2] == "{}":
            result += "{}"
            i += 2
        elif template[i] == "{":
            result += "{{"
            i += 1
        elif template[i] == "}":
            result += "}}"
            i += 1
        else:
            result += template[i]
            i += 1

    return result


positive_templates = [
    'const std::string {} = "{}";',
    'static const std::string {} = "{}";',
    'constexpr auto {} = "{}";',
    'inline constexpr auto {} = "{}";',
    'auto {} = "{}";',
    'std::string {} = "{}";',
    'static const char* {} = "{}";',
    'const char {}[] = "{}";',
    'char {}[] = "{}";',
    'namespace {} {{ inline const std::string {} = "{}"; }}',
    'namespace {} {{ constexpr auto {} = "{}"; }}',
    '#define {} "{}"',
    '#define {}_KEY "{}"',
    '#define SECRET_{} "{}"',
    '#define {}_SECRET "{}"',
    '#define TOKEN_{} "{}"',
    'std::map<std::string,std::string> {}{{ {{ "{}", "{}" }} }};',
    'std::unordered_map<std::string,std::string> {}{{ {{ "{}", "{}" }} }};',
    'std::vector<std::string> {} = {{ "{}" }};',
    'std::pair<std::string,std::string> {} = {{ "{}", "{}" }};',
    'std::tuple<std::string,std::string,std::string> {} = std::make_tuple("{}", "{}", "{}");',
    'auto {} = prefix + "{}";',
    'auto {} = suffix + "{}";',
    'auto {} = "{}" + salt;',
    'auto {} = R"({})";',
    'inline const std::string {}("{}");',
    'std::string {}( "{}" );',
    'connect(user, "{}");',
    'setSecret("{}", cfg);',
    'auth.setToken("{}");',
    'client.initialize("{}", "{}");',
    'const auto {} = decrypt("{}");',
    'std::string {} = loadSecret("{}", path);',
    'auto {} = config["secret"];',
    'auto {} = config["password"];',
    'auto {} = config["api_key"];',
    'constexpr char {}[] = "{}";',
    'std::array<char, {}> {} = {{}};',
    'const std::string {} = getenv("{}");',
    'auto {} = fetchKey("{}", url);',
    'std::string {} = "{}" + salt;',
    'static inline std::string {} = "{}";',
    'inline static const char* {} = "{}";',
    'struct {} {{ std::string {} = "{}"; }};',
    'struct {} {{ static constexpr auto {} = "{}"; }};',
    'class {} {{ public: const std::string {} = "{}"; }};',
    'auto {} = makeSecret("{}");',
    'auto {} = generateKey("{}");',
    'auto {} = getToken("{}");',
    'const std::string {} = "{}" + "{}";',
    'std::string {} = "{}" "" "{}";',
    'auto {} = "{}"sv;',
    'std::string {} = std::string("{}");',
    'std::string {} = std::move(std::string("{}"));',
    'std::string {} = std::format("{}", "{}");',
    'constexpr auto {} = R"({})";'
]

negative_templates = [
    'int {} = {};',
    'double {} = {}.0;',
    'float {} = {}.0f;',
    'std::string {} = "hello";',
    'std::string {} = "test";',
    'std::string {} = "{}";',
    'std::string filename = "{}";',
    'std::string path = "/tmp/{}";',
    'auto {} = compute();',
    'auto {} = process({});',
    'auto result = {};',
    'logger.info("step {}");',
    'logger.warn("value {}");',
    'logger.debug("x {} y {}");',
    'std::vector<int> {}({});',
    'std::vector<double> {}({});',
    'std::array<int, {}> {} = {{}};',
    'for (int i=0;i<{};++i) {{}}',
    'while (count < {}) {{ count++; }}',
    'if (flag) {{ do_work(); }}',
    'switch(x) {{ case {}: break; }}',
    'std::map<int,int> m{{}};',
    'std::unordered_set<int> s{{}};',
    'std::optional<int> opt = {};',
    'std::unique_ptr<int> ptr = std::make_unique<int>({});',
    'std::shared_ptr<int> sp = std::make_shared<int>({});',
    'std::thread t([]() {{ ; }});',
    'std::mutex mtx;',
    'std::condition_variable cv;',
    'auto value = {} + {};',
    'auto total = {} * {};',
    'const int LIMIT = {};',
    'constexpr int MAX = {};',
    'enum class Color {{ RED = {}, GREEN = {}, BLUE = {} }};',
    'std::string msg = "no secret here";',
    'auto lambda = [](int x) {{ return x + {}; }};',
    'std::vector<std::string> words = {{ "a", "b", "c" }};',
    'std::filesystem::path p = "/home/user";',
    'std::ofstream ofs("file{}.txt");',
    'std::ifstream ifs("file{}.txt");',
    'std::map<std::string,int> stats{{}};',
    'std::unordered_map<int,std::string> table{{}};',
    '#include <iostream>',
    '#include <fstream>',
    '#include <sstream>',
    '#include <string>',
    '#include <string_view>',
    '#include <vector>',
    '#include <array>',
    '#include <deque>',
    '#include <list>',
    '#include <set>',
    '#include <map>',
    '#include <unordered_set>',
    '#include <unordered_map>',
    '#include <optional>',
    '#include <variant>',
    '#include <any>',
    '#include <tuple>',
    '#include <utility>',
    '#include <memory>',
    '#include <algorithm>',
    '#include <numeric>',
    '#include <iterator>',
    '#include <functional>',
    '#include <type_traits>',
    '#include <concepts>',
    '#include <limits>',
    '#include <cmath>',
    '#include <cstdlib>',
    '#include <cstdint>',
    '#include <cstddef>',
    '#include <cstring>',
    '#include <cassert>',
    '#include <chrono>',
    '#include <thread>',
    '#include <mutex>',
    '#include <shared_mutex>',
    '#include <condition_variable>',
    '#include <future>',
    '#include <atomic>',
    '#include <filesystem>',
    '#include <regex>',
    '#include <random>',
    '#include <locale>',
    '#include <codecvt>',
    '#include <windows.h>',
    '#include <winsock2.h>',
    '#include <ws2tcpip.h>',
    '#include <unistd.h>',
    '#include <sys/types.h>',
    '#include <sys/stat.h>',
    '#include <fcntl.h>',
    '#include <stdint.h>',
    '#include <stddef.h>',
    '#include <math.h>',
    '#include <stdlib.h>',
    '#include <string.h>',
    '#include <stdio.h>',
    '#include <errno.h>',
    '#include "pch.hpp"',
    '#include "main.hpp"',
    '#include "config.hpp"',
    '#include "types.hpp"',
    '#include "constants.hpp"',
    '#include "utilities.hpp"',
    '#include "helpers.hpp"',
    '#include "logging.hpp"',
    '#include "errors.hpp"',
    '#include "exceptions.hpp"',
    '#include "result.hpp"',
    '#include "status.hpp"',
    '#include "context.hpp"',
    '#include "application.hpp"',
    '#include "environment.hpp"',
    '#include "settings.hpp"',
    '#include "options.hpp"',
    '#include "parameters.hpp"',
    '#include "arguments.hpp"',
    '#include "version.hpp"',
    '#include "build.hpp"',
    '#include "platform.hpp"',
    '#include "compiler.hpp"',
    '#include "core/core.hpp"',
    '#include "core/types.hpp"',
    '#include "core/api.hpp"',
    '#include "core/context.hpp"',
    '#include "core/runtime.hpp"',
    '#include "io/file.hpp"',
    '#include "io/path.hpp"',
    '#include "io/stream.hpp"',
    '#include "io/reader.hpp"',
    '#include "io/writer.hpp"',
    '#include "net/http.hpp"',
    '#include "net/socket.hpp"',
    '#include "net/client.hpp"',
    '#include "net/server.hpp"',
    '#include "math/math.hpp"',
    '#include "math/vector.hpp"',
    '#include "math/matrix.hpp"',
    '#include "model/model.hpp"',
    '#include "model/inference.hpp"',
    '#include "model/session.hpp"',
    '#include "model/encoder.hpp"',
    '#include "model/decoder.hpp"',
    '#include "util/string.hpp"',
    '#include "util/time.hpp"',
    '#include "util/random.hpp"',
    '#include "util/hash.hpp"',
    '#include "../include/common.hpp"',
    '#include "../include/types.hpp"',
    '#include "../include/api.hpp"',
    '#include "./local.hpp"',
    '#include "./internal.hpp"',
    '#include "./private.hpp"',
    '#include "third_party/library.hpp"',
    '#include "vendor/dependency.hpp"',
    'import std;',
    'import std.core;',
    'import std.io;',
    'import std.filesystem;',
    'import std.threading;',
    'import std.math;',
    'import {};',
    'import {}.module;',
    'import std;',
    'import std.core;',
    'export module {};',
    'module {};',
    'using namespace std;',
    'using namespace std::chrono;',
    'using namespace {};',
    'namespace {} {{}}',
    'namespace {} {{ int x = {}; }}',
    'namespace {}::{} {{}}',
    'inline namespace {} {{}}',
    'namespace {{ int x = {}; }}',
    'class {};',
    'struct {};',
    'enum class {};',
    'union {};',
    'class {} {{}};',
    'struct {} {{}};',
    'class {} final {{}};',
    'struct {} final {{}};',
    'class {} {{ public: {}() = default; }};',
    'class {} {{ public: {}() {{}} }};',
    'class {} {{ public: virtual ~{}() = default; }};',
    'class {} {{ private: int x; }};',
    'class {} {{ protected: int x; }};',
    'class {} {{ public: int x; }};',
    'class {} : public {} {{}};',
    'class {} : private {} {{}};',
    'class {} : protected {} {{}};',
    'struct {} : {} {{}};',
    'struct {} : public {} {{}};',
    'class {} {{ public: void {}(); }};',
    'class {} {{ public: static int {}; }};',
    'class {} {{ public: inline static int {} = {}; }};',
    'struct {} {{ int x; double y; }};',
    'struct {} {{ std::string name; std::size_t size; }};',
    'template<typename T> class {} {{}};',
    'template<typename T> struct {} {{ T value; }};',
    'template<typename T, typename U> struct {} {{}};',
    'template<int N> struct {} {{}};',
    'template<typename T> using {} = std::vector<T>;',
    'template<typename T> T {}(T v);',
    'template<typename T> T {}(T v) {{ return v; }}',
    'inline void {}() {{}}',
    'static void {}() {{}}',
    'constexpr int {}() {{ return {}; }}',
    'extern int {};',
    'extern const char* {};',
    'extern "C" void {}();',
    'using {} = int;',
    'using {} = std::vector<int>;',
    'typedef int {};',
    'typedef std::unordered_map<int,int> {};',
    'struct {} {{ {}() = default; }};',
    'struct {} {{ {}(int x) : value(x) {{}} int value; }};',
    'class {} {{ public: {}(const {}&) = default; }};',
    'class {} {{ public: {}& operator=(const {}&) = default; }};',
    'class {} {{ public: {}({}&&) noexcept = default; }};',
    'class {} {{ public: ~{}() = default; }};',
    'namespace {} {{ class {} {{}}; }}',
    'namespace {} {{ struct {} {{}}; }}',
    'namespace {} {{ using {} = int; }}',
    'namespace {} {{ namespace {} {{}} }}',
    'namespace {} {{ inline namespace {} {{}} }}',
    'struct {} {{ virtual void {}() = 0; }};',
    'struct {} {{ virtual void {}() {{}} }};',
    'class {} {{ public: virtual int {}() const {{ return {}; }} }};',
    'class {} {{ public: bool operator==(const {}) const {{ return true; }} }};',
    'class {} {{ friend class {}; }};',
    'class {} {{ friend void {}(); }};',
    'static_assert({}, "ok");',
    'static_assert(true);',
    'constexpr auto {} = {};',
    'inline constexpr int {} = {};',
    'namespace {} {{ constexpr int {} = {}; }}',
    'static int {};',
    'static float {};',
    'static double {};',
    'static char {};',
    'static bool {};',
    'static constexpr int {} = {};',
    'static constexpr char {} = \'{}\';',
    'static constexpr bool {} = {};',
    'static const int {};',
    'static const char {};',
    'static const char* {};',
    'static const float {};',
    'static inline int {};',
    'static inline double {};',
    'static inline void {}();',
    'static void {}();',
    'static int {}();',
    'static double {}();',
    'static float {}();',
    'static bool {}();',
    'static char {}();',
    'static int {}(int);',
    'static double {}(double);',
    'static float {}(float);',
    'static bool {}(bool);',
    'static char {}(char);',
    'static int {}(int, int);',
    'static double {}(double, double);',
    'static float {}(float, float);',
    'static void {}(int);',
    'static void {}(double);',
    'static void {}(float);',
    'static int {}(const int&);',
    'static double {}(const double&);',
    'static float {}(const float&);',
    'static void {}(const char*);',
    'static void {}(char);',
    'static int {}(char);',
    'static int {}(unsigned char);',
    'static constexpr int {}();',
    'static constexpr bool {}();',
    'static inline constexpr int {} = {};',
    'static int {}[{}];',
    'static char {}[{}];',
    'static int {} = {};',
    'static double {} = {};',
    'static float {} = {};',
    'static char {} = \'{}\';',
    'static bool {} = {};',
    'static int {}{};',
    'static char {}{};',
    'static double {}{};',
    'static void {}{}();',
    'static int {}{}();',
    'static {} {};',
    'static char c;',
    'static int i;',
    'static double d;',
    'static float f;',
    'static bool b;',
    'static int x;',
    'static int y;',
    'static int z;',
    'static char a;',
    'static char b;',
    'static char c;',
    'static void f();',
    'static void g();',
    'static void h();',
    'using namespace std;',
    'using namespace std::chrono;',
    'using namespace std::filesystem;',
    'using namespace std::string_literals;',
    'using namespace std::literals;',
    'using std::string;',
    'using std::vector;',
    'using std::map;',
    'using std::unordered_map;',
    'using std::optional;',
    'using std::unique_ptr;',
    'using std::shared_ptr;',
    'using std::size_t;',
    'using std::uint32_t;',
    'using std::int64_t;',
    'using std::cout;',
    'using std::cerr;',
    'using std::endl;',
    'using my_namespace::Type;',
    'using my_namespace::function;',
    'using my_namespace::value;',
    'using my_namespace::detail::impl;',
    'namespace ns {}',
    'namespace ns { }',
    'namespace ns { int x; }',
    'namespace ns::inner {}',
    'namespace {}',
    'namespace detail {}',
    'inline namespace v1 {}',
    'inline namespace v2 {}',
    'using namespace;',
    'using ::std;',
    'using ::std::vector;',
    'using ::std::string;',
    'using alias = int;',
    'using alias = std::vector<int>;',
    'using alias = std::map<int,int>;',
    'namespace std {}',
    'namespace user {}',
    'namespace internal {}',
    '#define {} {}',
    '#define {}() {}',
    '#undef {}',
    '#ifdef {}',
    '#ifndef {}',
    '#if defined({})',
    '#if !defined({})',
    '#else',
    '#elif {}',
    '#endif',
    '#pragma {}',
    '#include "{}"',    
    'namespace {} {{}}',
    'namespace {} {{ int {} = {}; }}',
    'namespace {} {{ void {}(); }}',
    'namespace {} {{ class {}; }}',
    'namespace {} {{ struct {}; }}',
    'namespace {}::{} {{}}',
    'inline namespace {} {{}}',
    'namespace detail {{}}',
    'namespace {} {{ inline namespace {} {{}} }}',    
    'namespace {} {{ class {} {{}}; }}',
    'namespace {} {{ struct {} {{ int x; }}; }}',
    'namespace {} {{ enum class {} {{ RED, GREEN, BLUE }}; }}',    
    'namespace {} {{ void {}(); }}',
    'namespace {} {{ int {}(); }}',
    'namespace {} {{ template<typename T> void {}(T val); }}',    
    'class {};',
    'struct {};',
    'enum class {};',
    'union {};',    
    'class {} {{}};',
    'struct {} {{}};',
    'class {} final {{}};',
    'struct {} final {{}};',    
    'class {} {{ public: static int {}; }};',
    'class {} {{ public: static void {}(); }};',
    'struct {} {{ static constexpr int {} = {}; }};',
    'struct {} {{ static inline int {}; }};',    
    'template<typename T> class {} {{}};',
    'template<typename T> struct {} {{ T value; }};',
    'template<typename T, typename U> struct {} {{}};',
    'template<int N> struct {} {{}};',
    'template<typename T> T {}(T val);',    
    'extern int {};',
    'extern const char* {};',
    'using {} = int;',
    'using {} = std::vector<int>;',
    'typedef int {};',
    'typedef std::unordered_map<int,int> {};',
    'static_assert({}, "ok");',
    'static_assert(true);',
    'constexpr auto {} = {};',
    'inline constexpr int {} = {};',
    'a','b','c','d','e','f','g','h','i','j','k','l','m',
    'n','o','p','q','r','s','t','u','v','w','x','y','z',
    'A','B','C','D','E','F','G','H','I','J','K','L','M',
    'N','O','P','Q','R','S','T','U','V','W','X','Y','Z',
    '0','1','2','3','4','5','6','7','8','9',
    '_',
    '+','-','*','/','%',
    '=','<','>','!','&','|','^','~','?',
    '.',
    ',',
    ';',
    ':',
    '(',
    ')',
    '[',
    ']',
    '{',
    '}',
    '#',
    '@',
    '$',
    '\\',
    '/',
    '\'',
    '"',
    '`',
    '\n',
    '\t',
    ' '
]

negative_templates = [escape_braces(t) for t in negative_templates]

low_entropy_strings = [
    "file","data","log","config","hello","world","test","sample","input","output",
    "filename","filepath","file_path","fileName","FileName",
    "datafile","data_file","dataFile","DataFile",
    "logfile","log_file","logFile","LogFile",
    "configfile","config_file","configFile","ConfigFile",
    "testcase","test_case","testCase","TestCase",
    "sampledata","sample_data","sampleData","SampleData",
    "inputdata","input_data","inputData","InputData",
    "outputdata","output_data","outputData","OutputData",
    "buffer","cache","temp","temporary","tmp","value","count","index","number","name",
    "text","string","message","msg","content","line","row",
    "dummy","placeholder","example","example_input","example_PATH","demo","reference",
    "reference_data","sample_file","sample_log","sample_input","sample_output",
    "alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa",
    "test1","test2","sample1","sample2","fileA","fileB","dataA","dataB",
    "name1","name2","value1","value2","configA","configB","logA","logB",
    "inputA","inputB","outputA","outputB","example_file","example_data","example_log",
    "dummy_file","dummy_data","placeholder_text","placeholder_value",
    "no_secret","not_secret","public_data","generic","common","normal","regular","standard",
    "file123","data123","log123","config123","input123","output123",
    "abc","xyz","lorem","ipsum","foo","bar","baz",
    "hello123","world123","simple","basic","raw","clean","neutral",
    "temp_file","temp_data","tmp_file","tmp_data","local_file","local_data",
    "cache_file","cache_data","config_file","config_data","log_file","log_data",
    "user_file","user_data","system_file","system_data","default_file","default_data"
]

positive_varnames = [
    "key","secret","password","token","api_key","auth_key","k","val","value","credential",
    "session_key","access_token","refresh_token","secret_key","password_hash",
    "user_key","private_key","encryption_key","api_secret","auth_token"
]

base_values = [
    "x","y","z","val","value","item","count","index","key","token","data","name",
    "flag","status","tmp","buffer","input","output","result","line","row","col",
    "alpha","beta","gamma","delta","epsilon","i","j","k","n","m","total","sum","avg",
    "min_val","max_val","start","end","temp","placeholder","example","sample","demo",
    "user","admin","config","setting","option","param","parameter","key_name","key_value"
]

base_forms = [
    lambda s: s,
    lambda s: s.lower(),
    lambda s: s.upper(),
    lambda s: s.capitalize(),
    lambda s: s + "_" + s,
    lambda s: s + s,
    lambda s: s + "_" + s.lower(),
    lambda s: s.lower() + "_" + s.lower(),
]

vocabulary_json = """
{
  "<PAD>": 0,
  "<UNK>": 1,
  " ": 2,
  "!": 3,
  "\\"": 4,
  "#": 5,
  "$": 6,
  "%": 7,
  "&": 8,
  "'": 9,
  "(": 10,
  ")": 11,
  "*": 12,
  "+": 13,
  ",": 14,
  "-": 15,
  ".": 16,
  "/": 17,
  "0": 18,
  "1": 19,
  "2": 20,
  "3": 21,
  "4": 22,
  "5": 23,
  "6": 24,
  "7": 25,
  "8": 26,
  "9": 27,
  ":": 28,
  ";": 29,
  "<": 30,
  "=": 31,
  ">": 32,
  "?": 33,
  "@": 34,
  "A": 35,
  "B": 36,
  "C": 37,
  "D": 38,
  "E": 39,
  "F": 40,
  "G": 41,
  "H": 42,
  "I": 43,
  "J": 44,
  "K": 45,
  "L": 46,
  "M": 47,
  "N": 48,
  "O": 49,
  "P": 50,
  "Q": 51,
  "R": 52,
  "S": 53,
  "T": 54,
  "U": 55,
  "V": 56,
  "W": 57,
  "X": 58,
  "Y": 59,
  "Z": 60,
  "[": 61,
  "\\\\": 62,
  "]": 63,
  "^": 64,
  "_": 65,
  "`": 66,
  "a": 67,
  "b": 68,
  "c": 69,
  "d": 70,
  "e": 71,
  "f": 72,
  "g": 73,
  "h": 74,
  "i": 75,
  "j": 76,
  "k": 77,
  "l": 78,
  "m": 79,
  "n": 80,
  "o": 81,
  "p": 82,
  "q": 83,
  "r": 84,
  "s": 85,
  "t": 86,
  "u": 87,
  "v": 88,
  "w": 89,
  "x": 90,
  "y": 91,
  "z": 92,
  "{": 93,
  "|": 94,
  "}": 95,
  "~": 96
}
"""
